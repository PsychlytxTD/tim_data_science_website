---
title: "Supercharged Data Cleaning with R (Part One - Data Import)"
author: Timothy Deitz, Clinical Psychologist & Data Science Consultant
date: '2019-11-23'
categories:
  - Data Cleaning
tags:
  - Data Cleaning
output:
  blogdown::html_page:
    toc: no
---



<style>
body.blue { background-color:#2b3f60;}
</style>
<div id="importing-the-data" class="section level2">
<h2>Importing the Data</h2>
<p>Real-world data is messy, irritating and cumbersome. Many tutorials on data wrangling with R simply don’t prepare you for it.</p>
<p>I begin by loading all required packages.</p>
<pre class="r"><code>library(fs)
library(readr)
library(here)
library(purrr)
library(janitor)
library(dplyr)
library(stringr)
library(naniar)
library(plotly)
library(stringr)
library(forcats)</code></pre>
<p>By using the <code>here()</code> function from the <code>fs</code> package (as opposed to an absolute file path), I ensure that people who have my data can run this script easily.</p>
<p>I next want to see which files are showing up in my working directory. I want import spreadsheets with a <code>.csv</code> extension and leave the original versions, which hav a <code>.xlsx</code> extension.</p>
<pre class="r"><code>fs::dir_ls(path = here())</code></pre>
<pre><code>## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/Rplot.png
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/data_import
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/data_import.Rproj
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/early_2019.csv
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/early_2019.xlsx
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/index.Rmd
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/index.html
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/mid_2017.csv
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/mid_2017.xlsx
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/mid_2018.csv
## /Users/timothyjamesdeitz/Documents/tim_website/tim_website/website_files/content/post/data_import/mid_2018.xlsx</code></pre>
<p>I use a basic regular expression to capture only the csv files. Then I import each of these files and store them as separate dataframes in a list.</p>
<pre class="r"><code>csv_files&lt;- fs::dir_ls(here(), regexp = &quot;\\.csv$&quot;)

pain_data_raw&lt;- csv_files %&gt;% purrr::map( ~readr::read_csv(.x)) %&gt;% 
  purrr::set_names(&quot;early_19&quot;, &quot;mid_17&quot;, &quot;mid_18&quot;)</code></pre>
<p>Check there is now a list of 3 dataframes:</p>
<pre class="r"><code>str(pain_data_raw, max.level = 0)</code></pre>
<pre><code>## List of 3</code></pre>
<p>It seems to have worked. But I want to check that each dataframe has the same variables, and that these variables have identical data types (character, logical, numeric etc.). The <code>compare_df_cols()</code> function from the <code>janitor</code> package lets you compare multiple dataframes according to the presence and data type of the variables they contain.</p>
<p>The output reveals a problem: some variables have a different data type depending on the dataframe they belong to!</p>
<pre class="r"><code>data_comparison&lt;- janitor::compare_df_cols(pain_data_raw)

data_comparison %&gt;% dplyr::filter(column_name == &#39;EEnd_BPIPainInterference&#39;)</code></pre>
<pre><code>##                column_name early_19    mid_17  mid_18
## 1 EEnd_BPIPainInterference  numeric character numeric</code></pre>
<p>For example, the <code>EEnd_BPIPainInterference</code> column (which measures pain interference in daily activities) is specified as a numeric variable for the first and third the dataframes, but as a character varible in the second dataframe. This is most likely due to an error when data was entered into one of the spreadsheets.</p>
<p>When you have many columns (i.e. more than 100) and data entry mistakes are probably, it is sometimes best to manually import all columns as character variables, and then alter their type later. This can be done by adding <code>col_types = cols(.default = &quot;c&quot;)</code> to the original code.</p>
<pre class="r"><code>pain_data_raw&lt;- csv_files %&gt;% purrr::map( ~readr::read_csv(.x, col_types = cols(.default = &quot;c&quot;))) %&gt;% 
  purrr::set_names(&quot;early_19&quot;, &quot;mid_17&quot;, &quot;mid_18&quot;)</code></pre>
<p>If I now compare each dataframe again, all variables are of the character type. But there is another problem. Certain variables appear in one dataframe but not others, or appear in two dataframes but not in the third.</p>
<pre class="r"><code>head(data_comparison)</code></pre>
<pre><code>##         column_name early_19  mid_17    mid_18
## 1        Aboriginal  numeric numeric   numeric
## 2         ACCFunded  numeric numeric      &lt;NA&gt;
## 3               age  numeric numeric      &lt;NA&gt;
## 4         age_group  numeric numeric      &lt;NA&gt;
## 5 BPIAverage_change     &lt;NA&gt;    &lt;NA&gt; character
## 6  BPIAverage_group     &lt;NA&gt;    &lt;NA&gt; character</code></pre>
<p>I <strong>only</strong> want to retain variables that are common to each dataframe. The first step in doing so is to store the names of these shared variables in a character vector.</p>
<pre class="r"><code>matching_vars&lt;- data_comparison %&gt;% dplyr::filter_at(vars(-column_name), all_vars(!is.na(.))) %&gt;% 
  dplyr::select(column_name) %&gt;% dplyr::pull(1)

#Have a look

head(matching_vars)</code></pre>
<pre><code>## [1] &quot;Aboriginal&quot;      &quot;CancerPain&quot;      &quot;CMAnaemia&quot;       &quot;CMBloodPressure&quot;
## [5] &quot;CMCancer&quot;        &quot;CMDepression&quot;</code></pre>
<p>I then iterate through each dataframe and select variables contained in the character vector.</p>
<pre class="r"><code>pain_data_complete&lt;- pain_data_raw %&gt;% purrr::map(~dplyr::select(.x, matching_vars))</code></pre>
<p>Each dataframe should now have the same number of coluumns.</p>
<pre class="r"><code>purrr::map_dbl(pain_data_complete, ncol)</code></pre>
<pre><code>## early_19   mid_17   mid_18 
##      273      273      273</code></pre>
<p>Success!!!</p>
<p>Finally, I join the three dataframes into a single dataframe.</p>
<pre class="r"><code>joined_data&lt;- dplyr::bind_rows(pain_data_complete)

#Check it worked  

glimpse(joined_data) %&gt;% print(n = 10)</code></pre>
<pre><code>## Observations: 275
## Variables: 273
## $ Aboriginal                    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CancerPain                    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ CMAnaemia                     &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMBloodPressure               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMCancer                      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMDepression                  &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, NA, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMDiabetes                    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMHeart                       &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMKidney                      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMLung                        &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMOsteoarthritis              &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMOther                       &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMRheumatoid                  &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMStroke                      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CMUlcer                       &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ CommunicationAssist           &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ ComorbiditiesOther            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ CompensationCase              &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;,…
## $ CompensationCaseType          &lt;chr&gt; &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;3&quot;, &quot;9&quot;, &quot;1&quot;, &quot;-4&quot;…
## $ CompensationOtherDetail       &lt;chr&gt; &quot;Worksafe&quot;, &quot;Worksafe&quot;, &quot;TAC&quot;, NA,…
## $ CountryOfBirth                &lt;chr&gt; &quot;9&quot;, &quot;1&quot;, &quot;1&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;9&quot;,…
## $ CountryOfBirthOther           &lt;chr&gt; NA, NA, NA, NA, NA, NA, &quot;Germany&quot;,…
## $ DOB                           &lt;chr&gt; &quot;6/10/82&quot;, &quot;6/12/66&quot;, &quot;30/8/94&quot;, &quot;…
## $ EEnd_BPIActivity              &lt;chr&gt; &quot;5&quot;, &quot;3&quot;, &quot;4&quot;, &quot;3&quot;, &quot;10&quot;, &quot;8&quot;, &quot;4&quot;…
## $ EEnd_BPIAverage               &lt;chr&gt; &quot;6&quot;, &quot;5&quot;, &quot;5&quot;, &quot;3&quot;, &quot;8&quot;, &quot;7&quot;, &quot;4&quot;,…
## $ EEnd_BPIEnjoyment             &lt;chr&gt; &quot;9&quot;, &quot;3&quot;, &quot;3&quot;, &quot;7&quot;, &quot;10&quot;, &quot;5&quot;, &quot;3&quot;…
## $ EEnd_BPILeast                 &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;8&quot;, &quot;4&quot;, &quot;1&quot;,…
## $ EEnd_BPIMainPain              &lt;chr&gt; &quot;81&quot;, &quot;78&quot;, &quot;83&quot;, &quot;83&quot;, &quot;65&quot;, &quot;83&quot;…
## $ EEnd_BPIMood                  &lt;chr&gt; &quot;8&quot;, &quot;6&quot;, &quot;7&quot;, &quot;6&quot;, &quot;10&quot;, &quot;5&quot;, &quot;5&quot;…
## $ EEnd_BPINow                   &lt;chr&gt; &quot;7&quot;, &quot;6&quot;, &quot;4&quot;, &quot;1&quot;, &quot;8&quot;, &quot;7&quot;, &quot;2&quot;,…
## $ EEnd_BPIPainInterference      &lt;chr&gt; &quot;6.5714&quot;, &quot;5&quot;, &quot;3.7143&quot;, &quot;5.4286&quot;,…
## $ EEnd_BPIPainInterferenceEmpty &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_BPIPainSeverity          &lt;chr&gt; &quot;6&quot;, &quot;5.25&quot;, &quot;4.75&quot;, &quot;3.25&quot;, &quot;8.25…
## $ EEnd_BPIPainSeverityEmpty     &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_BPIRelations             &lt;chr&gt; &quot;7&quot;, &quot;7&quot;, &quot;4&quot;, &quot;8&quot;, &quot;10&quot;, &quot;5&quot;, &quot;4&quot;…
## $ EEnd_BPISleep                 &lt;chr&gt; &quot;7&quot;, &quot;9&quot;, &quot;4&quot;, &quot;9&quot;, &quot;9&quot;, &quot;5&quot;, &quot;1&quot;,…
## $ EEnd_BPIWalking               &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;10&quot;, &quot;8&quot;, &quot;3&quot;…
## $ EEnd_BPIWork                  &lt;chr&gt; &quot;9&quot;, &quot;6&quot;, &quot;3&quot;, &quot;2&quot;, &quot;10&quot;, &quot;10&quot;, &quot;3…
## $ EEnd_BPIWorst                 &lt;chr&gt; &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;7&quot;…
## $ EEnd_CompDate                 &lt;chr&gt; &quot;16/1/18&quot;, &quot;16/4/18&quot;, &quot;14/2/18&quot;, &quot;…
## $ EEnd_CompStatus               &lt;chr&gt; &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;,…
## $ EEnd_CountAnalgAll            &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;.&quot;, &quot;.&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;,…
## $ EEnd_CountAnalgExOpi          &lt;chr&gt; &quot;-2&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;…
## $ EEnd_DailyMorphine            &lt;chr&gt; &quot;0&quot;, &quot;40&quot;, &quot;-4&quot;, &quot;-4&quot;, &quot;30&quot;, &quot;0&quot;, …
## $ EEnd_DASSAnxiety              &lt;chr&gt; &quot;28&quot;, &quot;4&quot;, &quot;8&quot;, &quot;0&quot;, &quot;30&quot;, &quot;0&quot;, &quot;8…
## $ EEnd_DASSAnxietyEmpty         &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSDepression           &lt;chr&gt; &quot;40&quot;, &quot;12&quot;, &quot;16&quot;, &quot;14&quot;, &quot;42&quot;, &quot;2&quot;,…
## $ EEnd_DASSDepressionEmpty      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ1                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ10                  &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ11                  &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ12                  &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ13                  &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ14                  &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;,…
## $ EEnd_DASSQ15                  &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ16                  &lt;chr&gt; &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ17                  &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;,…
## $ EEnd_DASSQ18                  &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ19                  &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ2                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;0&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ20                  &lt;chr&gt; &quot;2&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ21                  &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ3                   &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ4                   &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ5                   &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ EEnd_DASSQ6                   &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ7                   &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSQ8                   &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSQ9                   &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_DASSStress               &lt;chr&gt; &quot;42&quot;, &quot;22&quot;, &quot;26&quot;, &quot;12&quot;, &quot;42&quot;, &quot;6&quot;,…
## $ EEnd_DASSStressEmpty          &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_DASSTotal                &lt;chr&gt; &quot;110&quot;, &quot;38&quot;, &quot;50&quot;, &quot;26&quot;, &quot;114&quot;, &quot;8…
## $ EEnd_DASSTotalEmpty           &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_EFullTime                &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EHomeDuties              &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_ELeavePain               &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_ELimitedHours            &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EPartTime                &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_ERetired                 &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_ERetraining              &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EStudy                   &lt;chr&gt; &quot;1&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EUnemployedNotPain       &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EUnemployedPain          &lt;chr&gt; &quot;1&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_EVoluntary               &lt;chr&gt; &quot;0&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_GenDate                  &lt;chr&gt; &quot;19/12/17&quot;, &quot;10/4/18&quot;, &quot;7/2/18&quot;, &quot;…
## $ EEnd_Height                   &lt;chr&gt; &quot;-2&quot;, &quot;170&quot;, &quot;165&quot;, &quot;185&quot;, &quot;179&quot;, …
## $ EEnd_HoursWorked              &lt;chr&gt; &quot;-2&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;…
## $ EEnd_HSUAlliedHealth          &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;30&quot;, &quot;5&quot;, &quot;8&quot;…
## $ EEnd_HSUDiagnosticTests       &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_HSUED                    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_HSUGP                    &lt;chr&gt; &quot;0&quot;, &quot;3&quot;, &quot;1&quot;, &quot;0&quot;, &quot;15&quot;, &quot;2&quot;, &quot;7&quot;…
## $ EEnd_HSUHospital              &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_HSUSpecialist            &lt;chr&gt; &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ EEnd_OpioidFreq               &lt;chr&gt; &quot;0&quot;, &quot;1&quot;, &quot;-4&quot;, &quot;-4&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1…
## $ EEnd_OpioidMaint              &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;-4&quot;, &quot;-4&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0…
## $ EEnd_PainDescription          &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ EEnd_PCSHelplessness          &lt;chr&gt; &quot;23&quot;, &quot;8&quot;, &quot;8&quot;, &quot;6&quot;, &quot;24&quot;, &quot;10&quot;, &quot;…
## $ EEnd_PCSHelplessnessEmpty     &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PCSMagnification         &lt;chr&gt; &quot;12&quot;, &quot;1&quot;, &quot;2&quot;, &quot;1&quot;, &quot;10&quot;, &quot;5&quot;, &quot;0…
## $ EEnd_PCSMagnificationEmpty    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PCSQ1                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;2&quot;, &quot;0&quot;, &quot;4&quot;, &quot;2&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ10                   &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ11                   &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;3&quot;, &quot;4&quot;, &quot;4&quot;, &quot;2&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ12                   &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;2&quot;, &quot;4&quot;, &quot;2&quot;, &quot;0&quot;,…
## $ EEnd_PCSQ13                   &lt;chr&gt; &quot;4&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;3&quot;, &quot;3&quot;, &quot;0&quot;,…
## $ EEnd_PCSQ2                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ3                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;3&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ4                    &lt;chr&gt; &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;, &quot;4&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ5                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_PCSQ6                    &lt;chr&gt; &quot;4&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;4&quot;, &quot;2&quot;, &quot;0&quot;,…
## $ EEnd_PCSQ7                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PCSQ8                    &lt;chr&gt; &quot;4&quot;, &quot;0&quot;, &quot;2&quot;, &quot;1&quot;, &quot;4&quot;, &quot;2&quot;, &quot;2&quot;,…
## $ EEnd_PCSQ9                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;4&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EEnd_PCSRumination            &lt;chr&gt; &quot;16&quot;, &quot;3&quot;, &quot;7&quot;, &quot;11&quot;, &quot;15&quot;, &quot;7&quot;, &quot;…
## $ EEnd_PCSRuminationEmpty       &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PCSTotal                 &lt;chr&gt; &quot;51&quot;, &quot;12&quot;, &quot;17&quot;, &quot;18&quot;, &quot;49&quot;, &quot;22&quot;…
## $ EEnd_PCSTotalEmpty            &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PSEQEmpty                &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ EEnd_PSEQQ1                   &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;5&quot;, &quot;5&quot;, &quot;0&quot;, &quot;1&quot;, &quot;5&quot;,…
## $ EEnd_PSEQQ10                  &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;0&quot;, &quot;1&quot;, &quot;6&quot;,…
## $ EEnd_PSEQQ2                   &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ EEnd_PSEQQ3                   &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;1&quot;, &quot;4&quot;, &quot;0&quot;, &quot;4&quot;, &quot;3&quot;,…
## $ EEnd_PSEQQ4                   &lt;chr&gt; &quot;2&quot;, &quot;5&quot;, &quot;3&quot;, &quot;4&quot;, &quot;0&quot;, &quot;2&quot;, &quot;4&quot;,…
## $ EEnd_PSEQQ5                   &lt;chr&gt; &quot;1&quot;, &quot;6&quot;, &quot;4&quot;, &quot;4&quot;, &quot;1&quot;, &quot;4&quot;, &quot;4&quot;,…
## $ EEnd_PSEQQ6                   &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;3&quot;, &quot;4&quot;, &quot;0&quot;, &quot;2&quot;, &quot;4&quot;,…
## $ EEnd_PSEQQ7                   &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;3&quot;, &quot;6&quot;, &quot;0&quot;, &quot;2&quot;, &quot;2&quot;,…
## $ EEnd_PSEQQ8                   &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;5&quot;, &quot;4&quot;, &quot;0&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ EEnd_PSEQQ9                   &lt;chr&gt; &quot;0&quot;, &quot;5&quot;, &quot;4&quot;, &quot;4&quot;, &quot;0&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ EEnd_PSEQTotal                &lt;chr&gt; &quot;8&quot;, &quot;36&quot;, &quot;35&quot;, &quot;42&quot;, &quot;3&quot;, &quot;23&quot;, …
## $ EEnd_SentStatus               &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ EEnd_SurveyCategoryID         &lt;chr&gt; &quot;6&quot;, &quot;8&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;,…
## $ EEnd_SurveyKey                &lt;chr&gt; &quot;EPW11386&quot;, &quot;EPW11569&quot;, &quot;EPW11492&quot;…
## $ EEnd_SurveyScheduleID         &lt;chr&gt; &quot;1386&quot;, &quot;1569&quot;, &quot;1492&quot;, &quot;2014&quot;, &quot;1…
## $ EEnd_Weight                   &lt;chr&gt; &quot;66&quot;, &quot;72&quot;, &quot;80&quot;, &quot;96&quot;, &quot;78&quot;, &quot;105…
## $ EEnd_WorkHoursAffected        &lt;chr&gt; &quot;1&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EEnd_WorkTypeAffected         &lt;chr&gt; &quot;1&quot;, NA, NA, NA, NA, NA, NA, NA, N…
## $ EpisodeEndDate                &lt;chr&gt; &quot;19/12/17&quot;, &quot;11/4/18&quot;, &quot;18/1/18&quot;, …
## $ EpisodeEndMode                &lt;chr&gt; &quot;5&quot;, &quot;5&quot;, &quot;1&quot;, &quot;5&quot;, &quot;5&quot;, &quot;5&quot;, &quot;5&quot;,…
## $ EpisodeEndModeOther           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ EpisodeID                     &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ EpisodeStartDate              &lt;chr&gt; &quot;1/5/17&quot;, &quot;4/5/17&quot;, &quot;13/7/17&quot;, &quot;3/…
## $ EpisodeStartMode              &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;,…
## $ FacilityID                    &lt;chr&gt; &quot;EPW1&quot;, &quot;EPW1&quot;, &quot;EPW1&quot;, &quot;EPW1&quot;, &quot;E…
## $ HearingSightImpaired          &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ InterpreterLanguage           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ InterpreterReqd               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Maori                         &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ NonIndigenous                 &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, NA, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, …
## $ PainDuration                  &lt;chr&gt; &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;3&quot;, &quot;3&quot;, &quot;2&quot;,…
## $ PainSource                    &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;5&quot;, &quot;5&quot;, &quot;2&quot;, &quot;2&quot;, &quot;4&quot;,…
## $ PainSourceOtherDetail         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ Patient.Identifier            &lt;chr&gt; &quot;CW&quot;, &quot;RW&quot;, &quot;RT&quot;, &quot;RT&quot;, &quot;CW&quot;, &quot;CW&quot;…
## $ PatientID                     &lt;chr&gt; &quot;243&quot;, &quot;257&quot;, &quot;284&quot;, &quot;285&quot;, &quot;300&quot;,…
## $ Postcode                      &lt;chr&gt; &quot;3178&quot;, &quot;3032&quot;, &quot;3134&quot;, &quot;3162&quot;, &quot;3…
## $ Ref_BPIActivity               &lt;chr&gt; &quot;10&quot;, &quot;7&quot;, &quot;7&quot;, &quot;4&quot;, &quot;7&quot;, &quot;6&quot;, &quot;7&quot;…
## $ Ref_BPIAverage                &lt;chr&gt; &quot;5&quot;, &quot;5&quot;, &quot;5&quot;, &quot;4&quot;, &quot;7&quot;, &quot;6&quot;, &quot;4&quot;,…
## $ Ref_BPIEnjoyment              &lt;chr&gt; &quot;10&quot;, &quot;6&quot;, &quot;6&quot;, &quot;7&quot;, &quot;9&quot;, &quot;5&quot;, &quot;8&quot;…
## $ Ref_BPILeast                  &lt;chr&gt; &quot;2&quot;, &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;7&quot;, &quot;2&quot;, &quot;2&quot;,…
## $ Ref_BPIMainPain               &lt;chr&gt; &quot;81&quot;, &quot;60&quot;, &quot;83&quot;, &quot;83&quot;, &quot;65&quot;, &quot;83&quot;…
## $ Ref_BPIMood                   &lt;chr&gt; &quot;10&quot;, &quot;9&quot;, &quot;8&quot;, &quot;2&quot;, &quot;7&quot;, &quot;2&quot;, &quot;9&quot;…
## $ Ref_BPINow                    &lt;chr&gt; &quot;5&quot;, &quot;6&quot;, &quot;4&quot;, &quot;2&quot;, &quot;7&quot;, &quot;2&quot;, &quot;6&quot;,…
## $ Ref_BPIPainInterference       &lt;chr&gt; &quot;8&quot;, &quot;6.7143&quot;, &quot;5.5714&quot;, &quot;4&quot;, &quot;7.8…
## $ Ref_BPIPainInterferenceEmpty  &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_BPIPainSeverity           &lt;chr&gt; &quot;4.75&quot;, &quot;5.5&quot;, &quot;4.75&quot;, &quot;3.75&quot;, &quot;7.…
## $ Ref_BPIPainSeverityEmpty      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_BPIRelations              &lt;chr&gt; &quot;10&quot;, &quot;6&quot;, &quot;3&quot;, &quot;10&quot;, &quot;8&quot;, &quot;6&quot;, &quot;8…
## $ Ref_BPISleep                  &lt;chr&gt; &quot;6&quot;, &quot;9&quot;, &quot;5&quot;, &quot;1&quot;, &quot;9&quot;, &quot;5&quot;, &quot;2&quot;,…
## $ Ref_BPIWalking                &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;3&quot;, &quot;2&quot;, &quot;7&quot;, &quot;8&quot;, &quot;8&quot;,…
## $ Ref_BPIWork                   &lt;chr&gt; &quot;10&quot;, &quot;6&quot;, &quot;7&quot;, &quot;2&quot;, &quot;8&quot;, &quot;6&quot;, &quot;10…
## $ Ref_BPIWorst                  &lt;chr&gt; &quot;7&quot;, &quot;8&quot;, &quot;8&quot;, &quot;7&quot;, &quot;9&quot;, &quot;8&quot;, &quot;8&quot;,…
## $ Ref_CompDate                  &lt;chr&gt; &quot;1/5/17&quot;, &quot;2/6/17&quot;, &quot;12/7/17&quot;, &quot;18…
## $ Ref_CompStatus                &lt;chr&gt; &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;,…
## $ Ref_CountAnalgAll             &lt;chr&gt; &quot;0&quot;, &quot;3&quot;, &quot;3&quot;, &quot;.&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;,…
## $ Ref_CountAnalgExOpi           &lt;chr&gt; &quot;-2&quot;, &quot;-2&quot;, &quot;-2&quot;, &quot;.&quot;, &quot;-2&quot;, &quot;-2&quot;,…
## $ Ref_DailyMorphine             &lt;chr&gt; &quot;0&quot;, &quot;9&quot;, &quot;4&quot;, &quot;-4&quot;, &quot;60&quot;, &quot;0&quot;, &quot;9…
## $ Ref_DASSAnxiety               &lt;chr&gt; &quot;18.6667&quot;, &quot;4&quot;, &quot;8&quot;, &quot;2&quot;, &quot;28&quot;, &quot;2…
## $ Ref_DASSAnxietyEmpty          &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSDepression            &lt;chr&gt; &quot;39.6667&quot;, &quot;26&quot;, &quot;16&quot;, &quot;10&quot;, &quot;42&quot;,…
## $ Ref_DASSDepressionEmpty       &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSQ1                    &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;,…
## $ Ref_DASSQ10                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ11                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ Ref_DASSQ12                   &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;,…
## $ Ref_DASSQ13                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ14                   &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;,…
## $ Ref_DASSQ15                   &lt;chr&gt; &quot;2&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSQ16                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ17                   &lt;chr&gt; &quot;.&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ18                   &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ Ref_DASSQ19                   &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSQ2                    &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;0&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ Ref_DASSQ20                   &lt;chr&gt; &quot;2&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSQ21                   &lt;chr&gt; &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ3                    &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ4                    &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ Ref_DASSQ5                    &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ6                    &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;,…
## $ Ref_DASSQ7                    &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSQ8                    &lt;chr&gt; &quot;3&quot;, &quot;0&quot;, &quot;1&quot;, &quot;3&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_DASSQ9                    &lt;chr&gt; &quot;.&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ Ref_DASSStress                &lt;chr&gt; &quot;38&quot;, &quot;28&quot;, &quot;26&quot;, &quot;20&quot;, &quot;42&quot;, &quot;2&quot;,…
## $ Ref_DASSStressEmpty           &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_DASSTotal                 &lt;chr&gt; &quot;96.333&quot;, &quot;58&quot;, &quot;50&quot;, &quot;32&quot;, &quot;112&quot;,…
## $ Ref_DASSTotalEmpty            &lt;chr&gt; &quot;2&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_EFullTime                 &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, …
## $ Ref_EHomeDuties               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_ELeavePain                &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_ELimitedHours             &lt;chr&gt; &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_EPartTime                 &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_ERetired                  &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_ERetraining               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_EStudy                    &lt;chr&gt; &quot;1&quot;, &quot;0&quot;, &quot;1&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, …
## $ Ref_EUnemployedNotPain        &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_EUnemployedPain           &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_EVoluntary                &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## $ Ref_GenDate                   &lt;chr&gt; &quot;1/5/17&quot;, &quot;24/5/17&quot;, &quot;6/7/17&quot;, &quot;18…
## $ Ref_Height                    &lt;chr&gt; &quot;-2&quot;, &quot;171&quot;, &quot;163&quot;, &quot;183&quot;, &quot;179&quot;, …
## $ Ref_HoursWorked               &lt;chr&gt; &quot;-2&quot;, &quot;-2&quot;, &quot;16&quot;, &quot;.&quot;, &quot;-2&quot;, &quot;-2&quot;,…
## $ Ref_HSUAlliedHealth           &lt;chr&gt; &quot;1&quot;, &quot;24&quot;, &quot;3&quot;, &quot;3&quot;, &quot;4&quot;, &quot;6&quot;, &quot;3&quot;…
## $ Ref_HSUDiagnosticTests        &lt;chr&gt; &quot;0&quot;, &quot;-2&quot;, &quot;4&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;2&quot;…
## $ Ref_HSUED                     &lt;chr&gt; &quot;0&quot;, &quot;-2&quot;, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;…
## $ Ref_HSUGP                     &lt;chr&gt; &quot;3&quot;, &quot;1&quot;, &quot;4&quot;, &quot;0&quot;, &quot;7&quot;, &quot;3&quot;, &quot;8&quot;,…
## $ Ref_HSUHospital               &lt;chr&gt; &quot;0&quot;, &quot;-2&quot;, &quot;0&quot;, &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;0&quot;…
## $ Ref_HSUSpecialist             &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;,…
## $ Ref_OpioidFreq                &lt;chr&gt; &quot;0&quot;, &quot;1&quot;, &quot;1&quot;, &quot;-4&quot;, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;…
## $ Ref_OpioidMaint               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;-4&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;…
## $ Ref_PainDescription           &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;2&quot;,…
## $ Ref_PCSHelplessness           &lt;chr&gt; &quot;21&quot;, &quot;12&quot;, &quot;9&quot;, &quot;4&quot;, &quot;23&quot;, &quot;7&quot;, &quot;…
## $ Ref_PCSHelplessnessEmpty      &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_PCSMagnification          &lt;chr&gt; &quot;12&quot;, &quot;6&quot;, &quot;8&quot;, &quot;0&quot;, &quot;10&quot;, &quot;3&quot;, &quot;4…
## $ Ref_PCSMagnificationEmpty     &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_PCSQ1                     &lt;chr&gt; &quot;4&quot;, &quot;3&quot;, &quot;3&quot;, &quot;1&quot;, &quot;4&quot;, &quot;2&quot;, &quot;4&quot;,…
## $ Ref_PCSQ10                    &lt;chr&gt; &quot;4&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ Ref_PCSQ11                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;2&quot;, &quot;3&quot;,…
## $ Ref_PCSQ12                    &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;2&quot;, &quot;2&quot;,…
## $ Ref_PCSQ13                    &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;, &quot;1&quot;, &quot;0&quot;,…
## $ Ref_PCSQ2                     &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;3&quot;,…
## $ Ref_PCSQ3                     &lt;chr&gt; &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ Ref_PCSQ4                     &lt;chr&gt; &quot;4&quot;, &quot;3&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;1&quot;, &quot;2&quot;,…
## $ Ref_PCSQ5                     &lt;chr&gt; &quot;4&quot;, &quot;1&quot;, &quot;2&quot;, &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ Ref_PCSQ6                     &lt;chr&gt; &quot;4&quot;, &quot;3&quot;, &quot;4&quot;, &quot;0&quot;, &quot;4&quot;, &quot;2&quot;, &quot;3&quot;,…
## $ Ref_PCSQ7                     &lt;chr&gt; &quot;4&quot;, &quot;2&quot;, &quot;1&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;1&quot;,…
## $ Ref_PCSQ8                     &lt;chr&gt; &quot;4&quot;, &quot;0&quot;, &quot;1&quot;, &quot;1&quot;, &quot;4&quot;, &quot;2&quot;, &quot;3&quot;,…
## $ Ref_PCSQ9                     &lt;chr&gt; &quot;4&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;3&quot;,…
## $ Ref_PCSRumination             &lt;chr&gt; &quot;16&quot;, &quot;5&quot;, &quot;4&quot;, &quot;4&quot;, &quot;14&quot;, &quot;6&quot;, &quot;1…
## $ Ref_PCSRuminationEmpty        &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_PCSTotal                  &lt;chr&gt; &quot;49&quot;, &quot;23&quot;, &quot;21&quot;, &quot;8&quot;, &quot;47&quot;, &quot;16&quot;,…
## $ Ref_PCSTotalEmpty             &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_PSEQEmpty                 &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;,…
## $ Ref_PSEQQ1                    &lt;chr&gt; &quot;0&quot;, &quot;3&quot;, &quot;3&quot;, &quot;5&quot;, &quot;0&quot;, &quot;2&quot;, &quot;3&quot;,…
## $ Ref_PSEQQ10                   &lt;chr&gt; &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;3&quot;, &quot;5&quot;,…
## $ Ref_PSEQQ2                    &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;4&quot;, &quot;4&quot;, &quot;2&quot;, &quot;2&quot;, &quot;0&quot;,…
## $ Ref_PSEQQ3                    &lt;chr&gt; &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;4&quot;, &quot;2&quot;,…
## $ Ref_PSEQQ4                    &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;3&quot;, &quot;2&quot;,…
## $ Ref_PSEQQ5                    &lt;chr&gt; &quot;3&quot;, &quot;5&quot;, &quot;3&quot;, &quot;4&quot;, &quot;0&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ Ref_PSEQQ6                    &lt;chr&gt; &quot;0&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;3&quot;, &quot;2&quot;,…
## $ Ref_PSEQQ7                    &lt;chr&gt; &quot;6&quot;, &quot;1&quot;, &quot;0&quot;, &quot;2&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;,…
## $ Ref_PSEQQ8                    &lt;chr&gt; &quot;0&quot;, &quot;1&quot;, &quot;1&quot;, &quot;2&quot;, &quot;0&quot;, &quot;3&quot;, &quot;2&quot;,…
## $ Ref_PSEQQ9                    &lt;chr&gt; &quot;0&quot;, &quot;4&quot;, &quot;1&quot;, &quot;3&quot;, &quot;0&quot;, &quot;2&quot;, &quot;3&quot;,…
## $ Ref_PSEQTotal                 &lt;chr&gt; &quot;12&quot;, &quot;27&quot;, &quot;14&quot;, &quot;28&quot;, &quot;3&quot;, &quot;28&quot;,…
## $ Ref_SentStatus                &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;3&quot;,…
## $ Ref_SurveyCategoryID          &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ Ref_SurveyKey                 &lt;chr&gt; &quot;EPW1810&quot;, &quot;EPW1845&quot;, &quot;EPW1941&quot;, &quot;…
## $ Ref_SurveyScheduleID          &lt;chr&gt; &quot;810&quot;, &quot;845&quot;, &quot;941&quot;, &quot;1882&quot;, &quot;977&quot;…
## $ Ref_Weight                    &lt;chr&gt; &quot;60&quot;, &quot;73&quot;, &quot;189&quot;, &quot;98&quot;, &quot;76&quot;, &quot;10…
## $ Ref_WorkHoursAffected         &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, NA, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;, …
## $ Ref_WorkTypeAffected          &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, NA, &quot;1&quot;, &quot;0&quot;, &quot;1&quot;, …
## $ ReferralDate                  &lt;chr&gt; &quot;3/4/17&quot;, &quot;22/2/17&quot;, &quot;6/6/17&quot;, &quot;23…
## $ ReferralSource                &lt;chr&gt; &quot;11&quot;, &quot;10&quot;, &quot;10&quot;, &quot;10&quot;, &quot;10&quot;, &quot;10&quot;…
## $ ReferralSourceOther           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ Sex                           &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;,…
## $ State                         &lt;chr&gt; &quot;2&quot;, &quot;2&quot;, &quot;2&quot;, &quot;2&quot;, &quot;2&quot;, &quot;2&quot;, &quot;2&quot;,…
## $ TorresStraitIsl               &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, NA, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, …
## # A tibble: 275 x 273
##    Aboriginal CancerPain CMAnaemia CMBloodPressure CMCancer CMDepression
##    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;       
##  1 0          0          0         0               0        1           
##  2 0          0          0         0               0        1           
##  3 0          0          0         0               0        1           
##  4 &lt;NA&gt;       0          &lt;NA&gt;      &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;        
##  5 0          0          0         0               0        1           
##  6 0          0          0         0               0        0           
##  7 0          0          0         0               0        0           
##  8 0          0          0         0               0        1           
##  9 0          0          0         0               0        0           
## 10 0          0          0         0               0        0           
## # … with 265 more rows, and 267 more variables: CMDiabetes &lt;chr&gt;,
## #   CMHeart &lt;chr&gt;, CMKidney &lt;chr&gt;, CMLung &lt;chr&gt;, CMOsteoarthritis &lt;chr&gt;,
## #   CMOther &lt;chr&gt;, CMRheumatoid &lt;chr&gt;, CMStroke &lt;chr&gt;, CMUlcer &lt;chr&gt;,
## #   CommunicationAssist &lt;chr&gt;, ComorbiditiesOther &lt;chr&gt;,
## #   CompensationCase &lt;chr&gt;, CompensationCaseType &lt;chr&gt;,
## #   CompensationOtherDetail &lt;chr&gt;, CountryOfBirth &lt;chr&gt;,
## #   CountryOfBirthOther &lt;chr&gt;, DOB &lt;chr&gt;, EEnd_BPIActivity &lt;chr&gt;,
## #   EEnd_BPIAverage &lt;chr&gt;, EEnd_BPIEnjoyment &lt;chr&gt;, EEnd_BPILeast &lt;chr&gt;,
## #   EEnd_BPIMainPain &lt;chr&gt;, EEnd_BPIMood &lt;chr&gt;, EEnd_BPINow &lt;chr&gt;,
## #   EEnd_BPIPainInterference &lt;chr&gt;, EEnd_BPIPainInterferenceEmpty &lt;chr&gt;,
## #   EEnd_BPIPainSeverity &lt;chr&gt;, EEnd_BPIPainSeverityEmpty &lt;chr&gt;,
## #   EEnd_BPIRelations &lt;chr&gt;, EEnd_BPISleep &lt;chr&gt;, EEnd_BPIWalking &lt;chr&gt;,
## #   EEnd_BPIWork &lt;chr&gt;, EEnd_BPIWorst &lt;chr&gt;, EEnd_CompDate &lt;chr&gt;,
## #   EEnd_CompStatus &lt;chr&gt;, EEnd_CountAnalgAll &lt;chr&gt;,
## #   EEnd_CountAnalgExOpi &lt;chr&gt;, EEnd_DailyMorphine &lt;chr&gt;,
## #   EEnd_DASSAnxiety &lt;chr&gt;, EEnd_DASSAnxietyEmpty &lt;chr&gt;,
## #   EEnd_DASSDepression &lt;chr&gt;, EEnd_DASSDepressionEmpty &lt;chr&gt;,
## #   EEnd_DASSQ1 &lt;chr&gt;, EEnd_DASSQ10 &lt;chr&gt;, EEnd_DASSQ11 &lt;chr&gt;,
## #   EEnd_DASSQ12 &lt;chr&gt;, EEnd_DASSQ13 &lt;chr&gt;, EEnd_DASSQ14 &lt;chr&gt;,
## #   EEnd_DASSQ15 &lt;chr&gt;, EEnd_DASSQ16 &lt;chr&gt;, EEnd_DASSQ17 &lt;chr&gt;,
## #   EEnd_DASSQ18 &lt;chr&gt;, EEnd_DASSQ19 &lt;chr&gt;, EEnd_DASSQ2 &lt;chr&gt;,
## #   EEnd_DASSQ20 &lt;chr&gt;, EEnd_DASSQ21 &lt;chr&gt;, EEnd_DASSQ3 &lt;chr&gt;,
## #   EEnd_DASSQ4 &lt;chr&gt;, EEnd_DASSQ5 &lt;chr&gt;, EEnd_DASSQ6 &lt;chr&gt;,
## #   EEnd_DASSQ7 &lt;chr&gt;, EEnd_DASSQ8 &lt;chr&gt;, EEnd_DASSQ9 &lt;chr&gt;,
## #   EEnd_DASSStress &lt;chr&gt;, EEnd_DASSStressEmpty &lt;chr&gt;,
## #   EEnd_DASSTotal &lt;chr&gt;, EEnd_DASSTotalEmpty &lt;chr&gt;, EEnd_EFullTime &lt;chr&gt;,
## #   EEnd_EHomeDuties &lt;chr&gt;, EEnd_ELeavePain &lt;chr&gt;,
## #   EEnd_ELimitedHours &lt;chr&gt;, EEnd_EPartTime &lt;chr&gt;, EEnd_ERetired &lt;chr&gt;,
## #   EEnd_ERetraining &lt;chr&gt;, EEnd_EStudy &lt;chr&gt;,
## #   EEnd_EUnemployedNotPain &lt;chr&gt;, EEnd_EUnemployedPain &lt;chr&gt;,
## #   EEnd_EVoluntary &lt;chr&gt;, EEnd_GenDate &lt;chr&gt;, EEnd_Height &lt;chr&gt;,
## #   EEnd_HoursWorked &lt;chr&gt;, EEnd_HSUAlliedHealth &lt;chr&gt;,
## #   EEnd_HSUDiagnosticTests &lt;chr&gt;, EEnd_HSUED &lt;chr&gt;, EEnd_HSUGP &lt;chr&gt;,
## #   EEnd_HSUHospital &lt;chr&gt;, EEnd_HSUSpecialist &lt;chr&gt;,
## #   EEnd_OpioidFreq &lt;chr&gt;, EEnd_OpioidMaint &lt;chr&gt;,
## #   EEnd_PainDescription &lt;chr&gt;, EEnd_PCSHelplessness &lt;chr&gt;,
## #   EEnd_PCSHelplessnessEmpty &lt;chr&gt;, EEnd_PCSMagnification &lt;chr&gt;,
## #   EEnd_PCSMagnificationEmpty &lt;chr&gt;, EEnd_PCSQ1 &lt;chr&gt;, EEnd_PCSQ10 &lt;chr&gt;,
## #   EEnd_PCSQ11 &lt;chr&gt;, EEnd_PCSQ12 &lt;chr&gt;, EEnd_PCSQ13 &lt;chr&gt;,
## #   EEnd_PCSQ2 &lt;chr&gt;, …</code></pre>
<p>Having succeeded at importing and merging the data, it is a good idea to store the above steps into a reusable function.</p>
<pre class="r"><code>import_data&lt;- function() {

csv_files&lt;- fs::dir_ls(here(), regexp = &quot;\\.csv$&quot;)

pain_data_raw&lt;- csv_files %&gt;% purrr::map( ~readr::read_csv(.x, col_types = cols(.default = &quot;c&quot;))) %&gt;% 
  purrr::set_names(&quot;early_19&quot;, &quot;mid_17&quot;, &quot;mid_18&quot;)

data_comparison&lt;- janitor::compare_df_cols(pain_data_raw)

matching_vars&lt;- data_comparison %&gt;% dplyr::filter_at(vars(-column_name), all_vars(!is.na(.))) %&gt;% 
  dplyr::select(column_name) %&gt;% dplyr::pull(1)

pain_data_complete&lt;- pain_data_raw %&gt;% purrr::map(~dplyr::select(.x, matching_vars))

joined_data&lt;- dplyr::bind_rows(pain_data_complete)

}</code></pre>
<body class="blue">
</body>
</div>
